# Copilot instructions for lgNewsRoundup

This is a small static site that renders a curated RSS feed into a client-side newsbrief. Keep instructions short and specific to patterns found in the repo.

- **Big picture:** static single-page site. `index.html` + `styles.css` + `app.js` drive the UI. The page loads an RSS feed and renders a hero story plus a list of stories. The canonical feed is `https://lgnewsroundup.com/feed/` (tried first in `loadFeed()`); when that fails the client falls back to the local `feed.xml` in the repo.

- **Where to look:** primary logic in `app.js` (DOM rendering, feed parsing). Layout and theme tokens are in `styles.css`. Example content feed is `feed.xml`. Basic site copy and structure are in `index.html`.

- **Key patterns & functions (use these names when changing behavior):**
  - `loadFeed(url)` — attempts remote feed then local `feed.xml`, parses XML via `DOMParser`.
  - `normaliseItem(item)` — canonicalises RSS `<item>` to an object: `title`, `link`, `description`, `pubDate`, `categories`, `imageUrl`.
  - `extractImgSrc(htmlText)` — simple regex extractor for images inside HTML CDATA (used for `description` / `content:encoded`).
  - `setImageWithFallback(imgEl, src, alt)` — sets `img.src`, uses `logo.svg` fallback and lazy loading.

- **Important conventions & gotchas:**
  - CORS: the client first fetches the remote feed. Running locally will likely hit CORS and fall back to `./feed.xml`. To preview a live remote-like flow, serve the site from a webserver on a domain that can request the remote feed or mock the feed URL.
  - File expectations: the app expects `logo.svg` and `favicon.png` at repo root for fallbacks/branding.
  - Date formatting uses `toLocaleDateString('en-AU', ...)` in `formatDate()` — dates will be Australian-style.
  - The theme is toggled by writing `data-theme` on `document.documentElement` (`applyTheme()` / `initThemeToggle()`); prefer these helpers rather than manipulating classes directly.

- **Developer workflows / preview commands:**
  - Quick local preview (serves files on localhost):
    - `python -m http.server 8000` (then open `http://localhost:8000/`)
    - or `npx http-server -c-1` if you prefer Node tools.
  - Editing feed data: update `feed.xml` (this repo copy is the canonical local fallback). The upstream feed is generated by WordPress (see `feed.xml` content header). Prefer editing the CMS when possible.

- **Testing & debugging tips:**
  - Use browser DevTools Console to inspect `loadFeed()` errors — `app.js` logs parse/fetch errors and calls `showErrorState()`.
  - To test image fallback, remove `logo.svg` or point an item's `enclosure` to an invalid URL and watch `setImageWithFallback()` behaviour.
  - For feed parsing issues check for `parsererror` nodes after `DOMParser.parseFromString()` (this is what the code does today).

- **Integration points / external deps:**
  - Remote RSS: `https://lgnewsroundup.com/feed/` (hard-coded in `app.js`).
  - Google Fonts loaded in `index.html`.
  - Visual assets: `logo.svg`, `favicon.png` referenced in `index.html` and `app.js`.

- **When you change rendering logic:**
  - Keep `normaliseItem()` output shape stable (other rendering helpers expect `title`, `link`, `description`, `pubDate`, `categories`, `imageUrl`).
  - Deduplication is performed by URL+title in `loadFeed()` — if you change uniqueness rules update that dedupe logic too.

If anything above is unclear or you'd like me to expand a section (examples of common edits, test snippets, or a preview script), tell me which part to iterate on.
